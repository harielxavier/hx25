{"version":3,"file":"leadService-DYOWkoDo.js","sources":["../../src/services/leadService.ts"],"sourcesContent":["import { collection, addDoc, serverTimestamp, Timestamp } from 'firebase/firestore';\nimport { z } from 'zod';\nimport { db } from '../firebase/config';\n\n// Zod schema for Lead Submission\nconst leadSubmissionSchema = z.object({\n  firstName: z.string().min(1, { message: \"First name is required\" }),\n  lastName: z.string().min(1, { message: \"Last name is required\" }),\n  email: z.string().email({ message: \"Invalid email address\" }),\n  phone: z.string().optional(),\n  eventType: z.string().optional(),\n  eventDate: z.string().optional(), // Could be further validated with z.date() or a regex\n  eventLocation: z.string().optional(),\n  guestCount: z.string().optional(), // Could be z.number() if parsed\n  preferredStyle: z.array(z.string()).optional(),\n  mustHaveShots: z.string().optional(),\n  inspirationLinks: z.string().url({ message: \"Invalid URL for inspiration links\" }).optional().or(z.literal('')), // Allow empty string or valid URL\n  budget: z.string().optional(),\n  hearAboutUs: z.string().optional(),\n  additionalInfo: z.string().optional(),\n  source: z.string().optional(),\n});\n\nexport interface Lead {\n  firstName: string;\n  lastName: string;\n  email: string;\n  phone?: string;\n  eventType?: string;\n  eventDate?: string;\n  eventLocation?: string;\n  guestCount?: string;\n  preferredStyle?: string[];\n  mustHaveShots?: string;\n  inspirationLinks?: string;\n  budget?: string;\n  hearAboutUs?: string;\n  additionalInfo?: string;\n  status: 'new' | 'contacted' | 'qualified' | 'converted' | 'lost';\n  source: string;\n  createdAt: Timestamp;\n  updatedAt: Timestamp;\n}\n\nexport interface LeadSubmission {\n  firstName: string;\n  lastName: string;\n  email: string;\n  phone?: string;\n  eventType?: string;\n  eventDate?: string;\n  eventLocation?: string;\n  guestCount?: string;\n  preferredStyle?: string[];\n  mustHaveShots?: string;\n  inspirationLinks?: string;\n  budget?: string;\n  hearAboutUs?: string;\n  additionalInfo?: string;\n  source?: string;\n}\n\n/**\n * Create a new lead in Firestore\n * @param leadData The lead data to save\n * @returns Promise with the created lead ID\n */\nexport const createLead = async (leadData: LeadSubmission): Promise<string> => {\n  try {\n    // Validate leadData against the schema\n    const validatedData = leadSubmissionSchema.parse(leadData);\n\n    const leadsRef = collection(db, 'leads');\n    \n    const lead: Omit<Lead, 'id'> = {\n      ...validatedData, // Use validated data\n      status: 'new',\n      source: validatedData.source || 'website_form',\n      createdAt: serverTimestamp() as Timestamp,\n      updatedAt: serverTimestamp() as Timestamp\n    };\n    \n    const docRef = await addDoc(leadsRef, lead);\n    console.log('Lead created with ID:', docRef.id);\n    return docRef.id;\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      // Log Zod validation errors or rethrow as a custom error\n      console.error('Lead data validation error:', error.errors);\n      // You might want to throw a more specific error or handle it\n      // For example, throw new Error(`Validation failed: ${error.errors.map(e => e.message).join(', ')}`);\n    }\n    console.error('Error creating lead:', error);\n    throw error; // Rethrow the original error or a new one\n  }\n};\n\n/**\n * Submit a contact form and create a lead\n * @param formData The form data from the contact form\n * @returns Promise with the created lead ID\n */\nexport const submitContactForm = async (formData: LeadSubmission): Promise<string> => {\n  try {\n    // You could add additional processing here if needed\n    // For example, sending an email notification, etc.\n    \n    const leadId = await createLead(formData);\n    return leadId;\n  } catch (error) {\n    console.error('Error submitting contact form:', error);\n    throw error;\n  }\n};\n\n/**\n * Create sample test leads for testing the CRM\n * @returns Promise with success status\n */\nexport const createTestLeads = async (): Promise<boolean> => {\n  try {\n    const testLeads = [\n      {\n        firstName: 'Test',\n        lastName: 'A',\n        email: 'testa@example.com',\n        phone: '555-123-4567',\n        eventType: 'wedding',\n        eventDate: '2025-06-15',\n        eventLocation: 'Sparta, NJ',\n        guestCount: '150',\n        preferredStyle: ['Traditional', 'Candid'],\n        mustHaveShots: 'First look, family portraits, dance floor moments',\n        inspirationLinks: 'https://pinterest.com/myboard',\n        budget: '3500-5000',\n        hearAboutUs: 'instagram',\n        additionalInfo: 'Looking forward to our big day!',\n        source: 'test_data'\n      },\n      {\n        firstName: 'Test',\n        lastName: 'B',\n        email: 'testb@example.com',\n        phone: '555-987-6543',\n        eventType: 'engagement',\n        eventDate: '2025-04-30',\n        eventLocation: 'Central Park, NY',\n        guestCount: '2',\n        preferredStyle: ['Artistic', 'Natural/Lifestyle'],\n        mustHaveShots: 'Sunset photos, candid moments',\n        inspirationLinks: '',\n        budget: '2000-3500',\n        hearAboutUs: 'google',\n        additionalInfo: 'We want a mix of urban and nature settings',\n        source: 'test_data'\n      },\n      {\n        firstName: 'Test',\n        lastName: 'C',\n        email: 'testc@example.com',\n        phone: '555-456-7890',\n        eventType: 'family',\n        eventDate: '2025-05-10',\n        eventLocation: 'Client Home',\n        guestCount: '5',\n        preferredStyle: ['Candid', 'Natural/Lifestyle'],\n        mustHaveShots: 'Family group shots, individual portraits of children',\n        inspirationLinks: 'https://instagram.com/familyphotos',\n        budget: 'under-2000',\n        hearAboutUs: 'referral',\n        additionalInfo: 'We have a newborn and 2 toddlers',\n        source: 'test_data'\n      }\n    ];\n    \n    for (const lead of testLeads) {\n      await createLead(lead as LeadSubmission);\n      console.log(`Created test lead for ${lead.firstName} ${lead.lastName}`);\n    }\n    \n    return true;\n  } catch (error) {\n    console.error('Error creating test leads:', error);\n    return false;\n  }\n};\n"],"names":["z.object","z.string","z.array","z.literal","z.ZodError"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKA,MAAM,uBAAuBA,WAAS;AAAA,EACpC,WAAWC,WAAS,EAAE,IAAI,GAAG,EAAE,SAAS,0BAA0B;AAAA,EAClE,UAAUA,WAAS,EAAE,IAAI,GAAG,EAAE,SAAS,yBAAyB;AAAA,EAChE,OAAOA,WAAS,EAAE,MAAM,EAAE,SAAS,yBAAyB;AAAA,EAC5D,OAAOA,WAAS,EAAE,SAAS;AAAA,EAC3B,WAAWA,WAAS,EAAE,SAAS;AAAA,EAC/B,WAAWA,WAAS,EAAE,SAAS;AAAA;AAAA,EAC/B,eAAeA,WAAS,EAAE,SAAS;AAAA,EACnC,YAAYA,WAAS,EAAE,SAAS;AAAA;AAAA,EAChC,gBAAgBC,UAAQD,WAAU,CAAA,EAAE,SAAS;AAAA,EAC7C,eAAeA,WAAS,EAAE,SAAS;AAAA,EACnC,kBAAkBA,WAAE,EAAS,IAAI,EAAE,SAAS,qCAAqC,EAAE,WAAW,GAAGE,YAAU,EAAE,CAAC;AAAA;AAAA,EAC9G,QAAQF,WAAS,EAAE,SAAS;AAAA,EAC5B,aAAaA,WAAS,EAAE,SAAS;AAAA,EACjC,gBAAgBA,WAAS,EAAE,SAAS;AAAA,EACpC,QAAQA,WAAS,EAAE,SAAS;AAC9B,CAAC;AA8CY,MAAA,aAAa,CAAO,aAA8C;AACzE,MAAA;AAEI,UAAA,gBAAgB,qBAAqB,MAAM,QAAQ;AAEnD,UAAA,WAAW,WAAW,IAAI,OAAO;AAEvC,UAAM,OAAyB,iCAC1B,gBAD0B;AAAA;AAAA,MAE7B,QAAQ;AAAA,MACR,QAAQ,cAAc,UAAU;AAAA,MAChC,WAAW,gBAAgB;AAAA,MAC3B,WAAW,gBAAgB;AAAA,IAC7B;AAEA,UAAM,SAAS,MAAM,OAAO,UAAU,IAAI;AAClC,YAAA,IAAI,yBAAyB,OAAO,EAAE;AAC9C,WAAO,OAAO;AAAA,WACP,OAAO;AACV,QAAA,iBAAiBG,UAAY;AAEvB,cAAA,MAAM,+BAA+B,MAAM,MAAM;AAAA,IAAA;AAInD,YAAA,MAAM,wBAAwB,KAAK;AACrC,UAAA;AAAA,EAAA;AAEV;AAOa,MAAA,oBAAoB,CAAO,aAA8C;AAChF,MAAA;AAII,UAAA,SAAS,MAAM,WAAW,QAAQ;AACjC,WAAA;AAAA,WACA,OAAO;AACN,YAAA,MAAM,kCAAkC,KAAK;AAC/C,UAAA;AAAA,EAAA;AAEV;"}